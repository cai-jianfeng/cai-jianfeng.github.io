---
title: 'The Basic Knowledge of Expectation Maximization Algorithm'
data: 23-12-02
permalink: '/posts/2023/12/blog-em_algorithm'
tags:
  - 机器学习基础知识
---

<p style="text-align:justify; text-justify:inter-ideograph;">这篇博客参考了<a href="https://blog.csdn.net/qq_36583400/article/details/127047093" target="_blank">
通俗理解EM算法</a>，详细推导了 Expectation Maximization (EM) 算法。</p>

<h1>Preliminary</h1>

<p style="text-align:justify; text-justify:inter-ideograph;">点估计问题：假设总体 $X$ 的分布形式 $P(x)$ 已知，但是含有一个/多个位置参数 $\theta$，通过来自总体 $X$ 的一个样本来估计总体分布中未知参数值的问题。
例如假设已知总体 $X$ 的分布形式为高斯分布：$P(x) = \mathcal{N}(\mu, \sigma^2)$。
并且通过对总体 $X$ 进行采样，获得样本值 $x = \{x_1,...,x_n\}, x_i \in X$，如何使用 $x$ 来估计未知参数值 $\{\mu,\sigma\}$ 的问题就是点估计问题。</p>

<p style="text-align:justify; text-justify:inter-ideograph;">最大似然估计(max-likelihood estimation)：它是点估计问题的一种求解方法。
通常而言，概率越大的样本被采样到的可能性就越大。由于我们采样到了 $x_1,..,x_n$，那么按照常理来说，这些样本所对应的概率应该较大。
最大似然估计方法就是要估计出能使采样到 $x_1,..,x_n$ 这种情况出现<b>最大概率</b>的参数值。
(因为这已经是既定事实，我们已经采样到了 $x_1,..,x_n$，不考虑意外情况($x_i$ 概率很小却被采样到)，通过估计能使采样到 $x_1,..,x_n$ 出现最大概率的参数值来作为预测的参数值，
是在现有观察情况下(即只观察到 $x_1,..,x_n$)能给出的最合理的参数值。
<span style="color:red;">但是不一定是正确的参数值，也许我们的运气就是很背，采样到的 $x_1,..,x_n$ 在总体 $X$ 的分布中的实际概率很低，
那么此时最大似然估计所估计得到的参数值就会偏离正确的参数值很远。</span>因此最大似然估计是一个不考虑极端采样概率发生的参数估计方法。)</p>

<p style="text-align:justify; text-justify:inter-ideograph;">假设总体 $X$ 的分布形式 $P(X = x) = p(x;\theta), \theta \in \mathcal{\Theta}$，$X_1,...,X_n$ 是来自总体 $X$ 的一个样本，
则 $(X_1,...,X_n)$ 的联合分布律：</p>

$$P(X_1 = x_1,...,X_n=x_n) = \prod_{i=1}^np(x_i;\theta)$$

<p style="text-align:justify; text-justify:inter-ideograph;">根据上述分析，我们想让采样到 $x_1,..,x_n$ 这种情况出现最大概率，也就是使得上述的联合分布律最大，即</p>

$$\hat{\theta} = \underset{\theta \in }P(X_1 = x_1,...,X_n=x_n) = \prod_{i=1}^np(x_i;\theta)$$

<h1>Method</h1>

<p style="text-align:justify; text-justify:inter-ideograph;">EM 算法，即期望最大化算法，其目的是求解带有隐含变量 $z$ 的最大似然值的问题。
与一般的最大似然问题不同，后者一般只包含未知分布参数 $\theta$。
举个例子，假设一个学校的男生和女生的身高分布是一个高斯分布：$\mathcal{N}(\mu, \sigma^2)$，
其中的 $\mu_1, \sigma_1^2$ 表示男生身高分布的均值和方差；$\mu_2, \sigma_2^2$ 表示女生身高分布的均值和方差。
假设我们采样了 $50$ 个男生的身高分别为 $\{x_1^m,...,x_{50}^m\}$，$50$ 个女生的身高分别为 $\{x_1^w,...,x_{50}^w\}$。
在这种情况下求解对应的 $\mu_1,\sigma_1^2,\mu_2,\sigma_2^2 \rightarrow \theta$ 就是属于一般的最大似然问题。
假设我们采样了 $100$ 个同学的身高分别为 $\{x_1^z,...,x_{100}^z\}$，但是并不知道每个同学的性别 $z, z\in\{m,w\}$。
此时性别变量 $z$ 就属于隐含变量，而在这种情况下求解对应的 $\mu_1,\sigma_1^2,\mu_2,\sigma_2^2 \rightarrow \theta$ 就是属于带有隐含变量 $z$ 的最大似然问题。</p>

<p style="text-align:justify; text-justify:inter-ideograph;">由于增加了未知的隐含变量 $z$，
